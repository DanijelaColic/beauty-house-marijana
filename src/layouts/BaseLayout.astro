---
import "../styles/global.css";

export interface Props {
  title?: string;
  description?: string;
  ogImage?: string;
  canonical?: string;
}

// Apsolutni URL (radi samo ako je postavljen `site` u astro.config.mjs)
const site = Astro.site?.toString().replace(/\/$/, "") ?? "";
const ogUrl = `${site}/og-image.jpg`;

const {
  title = "Beauty House by Marijana Talović",
  description = "Elegantna njega kose u Osijeku. Brze online rezervacije i vrhunska usluga.",
  ogImage = ogUrl,
  canonical = site,
} = Astro.props;

const jsonLd = {
  "@context": "https://schema.org",
  "@type": "HairSalon",
  "name": "Beauty House by Marijana Talović",
  "address": {
    "@type": "PostalAddress",
    "streetAddress": "Ulica Jela 79",
    "addressLocality": "Osijek",
    "postalCode": "31000",
    "addressCountry": "HR"
  },
  "telephone": "+38531280678",
  "url": canonical,
  "image": ogImage,
  "openingHoursSpecification": [
    { "@type": "OpeningHoursSpecification", "dayOfWeek": ["Monday","Tuesday","Wednesday","Thursday","Friday"], "opens": "08:00", "closes": "20:00" },
    { "@type": "OpeningHoursSpecification", "dayOfWeek": "Saturday", "opens": "08:00", "closes": "14:00" }
  ]
};

---
<!DOCTYPE html>
<html lang="hr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
  
    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:url" content={site} />
    <meta property="og:image" content={ogUrl} />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:image:alt" content="Beauty House by Marijana Talović – frizerski salon Osijek" />
  
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogUrl} />
  
    <!-- Favicon (nije za preview, ali dobro imati) -->
    <link rel="icon" href="/favicon.png" />

    <!-- CSP: proširi domene po potrebi -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      base-uri 'self';
      object-src 'none';
      img-src 'self' data: blob: https:;
      font-src 'self' https: data:;
      style-src 'self' 'unsafe-inline';
      script-src 'self' 'unsafe-inline';
      connect-src 'self' https:;
      frame-src 'self' https://*.google.com https://www.google.com https://maps.google.com;
      frame-ancestors 'self';
      form-action 'self';
      upgrade-insecure-requests;
    ">

    <script type="application/ld+json">{JSON.stringify(jsonLd)}</script>
  </head>
  <body class="bg-background text-textPrimary">
    <slot />
  </body>
</html>
